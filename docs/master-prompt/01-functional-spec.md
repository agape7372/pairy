# 🧚 Pairy - 기능 명세서 (Functional Specification)

## 기능 우선순위 정의

| 우선순위 | 설명 | MVP 포함 |
|---------|------|---------|
| **P0** | 핵심 기능, 없으면 서비스 불가 | ✅ |
| **P1** | 중요 기능, 초기 출시에 필요 | ✅ |
| **P2** | 부가 기능, 출시 후 추가 | ❌ |
| **P3** | 향후 기능, 성장 단계 | ❌ |

---

## 1. 인증 시스템 (Authentication)

### 1.1 소셜 로그인 [P0]

#### 지원 플랫폼
- **Twitter/X** (필수 - 핵심 타겟)
- **Google** (필수 - 범용)
- Apple (P2)
- Discord (P2)

#### 기능 상세
```
[로그인 플로우]
1. "트위터로 로그인" 버튼 클릭
2. OAuth 팝업/리다이렉트
3. 권한 승인
4. 콜백 처리 → 유저 생성/로그인
5. 메인 페이지로 이동

[자동 수집 정보]
- 프로필 이미지 (Twitter 프사)
- 닉네임 (Twitter 표시명)
- 이메일 (선택적)
```

#### 비로그인 사용자 권한
- 틀 검색/열람 ✅
- 에디터 사용 (저장 불가) ✅
- 협업 참여 (게스트 모드) ✅
- 좋아요/북마크 ❌
- 고화질 저장 ❌

### 1.2 프로필 관리 [P1]

#### 프로필 필드
| 필드 | 필수 | 설명 |
|------|------|------|
| 닉네임 | ✅ | 2~20자, 중복 불가 |
| 프로필 이미지 | ❌ | 소셜에서 가져오기 or 업로드 |
| 자기소개 | ❌ | 최대 200자 |
| 트위터 링크 | ❌ | 공개 프로필용 |
| 테마 컬러 | ❌ | 프로필 커스터마이징 |

---

## 2. 틀 아카이브 (Template Archive)

### 2.1 틀 목록/검색 [P0]

#### 카테고리
| 카테고리 | 설명 | MVP |
|---------|------|-----|
| 페어틀 | 2인 관계 템플릿 | ✅ |
| 이메레스 | 캐릭터 프로필 템플릿 | P1 |
| 트레틀 | 트레이싱용 밑그림 | P2 |
| 프로필틀 | SNS 프로필용 | P2 |

#### 검색/필터 기능
```
[검색]
- 키워드 검색 (제목, 태그, 작가명)
- 자동완성 제안

[필터]
- 카테고리 (페어틀, 이메레스 등)
- 인원수 (2인, 3인, 4인+)
- 분위기 태그 (#귀여움 #다크 #감성 #코미디)
- 관계 태그 (#커플 #우정 #가족 #라이벌)
- 가격 (무료/유료)
- 정렬 (최신순, 인기순, 좋아요순)

[태그 시스템]
- 작가 지정 태그 (최대 10개)
- 시스템 추천 태그
- 인기 태그 목록
```

#### 틀 카드 표시 정보
```
┌─────────────────────────────┐
│  [썸네일 이미지]             │
│                             │
├─────────────────────────────┤
│  틀 제목                     │
│  @작가명                     │
│  ♥ 234  ⬇ 1.2k             │
│  #커플 #귀여움 #파스텔        │
│  무료 / ₩500                │
└─────────────────────────────┘
```

### 2.2 틀 상세 페이지 [P0]

#### 표시 정보
- 미리보기 이미지 (큰 버전)
- 제목, 설명
- 작가 정보 (프로필 링크)
- 태그 목록
- 좋아요 수, 사용 수
- 가격 (무료/유료)
- 이용 조건 (크레딧 필수 등)

#### 액션 버튼
| 버튼 | 조건 | 동작 |
|------|------|------|
| 에디터로 열기 | 무료 or 구매 완료 | 에디터 페이지로 이동 |
| 구매하기 | 유료 틀 | 결제 팝업 |
| 좋아요 | 로그인 | 토글 |
| 북마크 | 로그인 | 내 북마크에 저장 |
| 공유하기 | 모두 | 링크 복사 |
| 신고하기 | 로그인 | 신고 폼 |

### 2.3 틀 등록 (작가용) [P1]

#### 틀 파일 3중 분리 시스템

| 구분 | 형식 | 용도 | 필수 |
|------|------|------|------|
| 미리보기용 | JPG/PNG (압축) | 검색 결과, 썸네일 | ✅ |
| 에디터용 | JSON (레이어 정보) | 웹 에디터에서 편집 | ✅ |
| 원본 소장용 | PSD/AI 외부 링크 | 구매자 다운로드 | ❌ |

#### 등록 폼 필드
```
[기본 정보]
- 제목 (필수, 최대 50자)
- 설명 (선택, 최대 500자)
- 카테고리 (필수)
- 인원수 (필수)
- 태그 (필수, 최소 3개)

[파일 업로드]
- 미리보기 이미지 (필수)
- 에디터용 JSON (필수, 에디터에서 생성)
- 원본 파일 링크 (선택)

[가격 설정]
- 무료 / 유료
- 유료 시 가격 (₩100 ~ ₩50,000)

[이용 조건]
- 크레딧 필수 여부
- 상업적 이용 가능 여부
- 2차 수정 가능 여부

[편집 영역 설정]
- 이미지 삽입 영역 지정
- 텍스트 영역 지정
- 색상 변경 가능 영역 지정
```

### 2.4 좋아요/북마크 [P1]

#### 좋아요
- 토글 방식
- 즉시 반영 (Optimistic UI)
- 중복 방지

#### 북마크
- 폴더 분류 기능 (P2)
- 내 북마크 페이지에서 관리

---

## 3. 페어틀 웹 에디터 (Editor)

### 3.1 에디터 기본 기능 [P0]

#### 캔버스
```
[캔버스 설정]
- 크기: 틀 원본 비율 유지
- 배경: 틀 이미지
- 줌: 10% ~ 500%
- 이동: 드래그 or 스크롤

[레이어 구조]
1. 배경 레이어 (틀 이미지, 잠금)
2. 편집 레이어 (사용자 추가 요소)
3. 오버레이 레이어 (틀 전경, 잠금)
```

#### 지원 요소
| 요소 | 기능 | MVP |
|------|------|-----|
| 이미지 | 드래그&드롭, 크기/회전/위치 조절 | ✅ |
| 텍스트 | 추가/편집, 폰트/크기/색상 | ✅ |
| 도형 | 사각형, 원, 선 | P2 |
| 스티커 | 이모지, 장식 요소 | P2 |

### 3.2 이미지 편집 [P0]

#### 이미지 추가
```
[추가 방법]
1. 드래그 & 드롭 (파일에서)
2. 파일 선택 버튼
3. 클립보드 붙여넣기 (Ctrl+V)
4. URL 입력 (P2)

[지원 형식]
- JPG, PNG, GIF, WebP
- 최대 10MB

[자동 처리]
- 리사이징 (캔버스에 맞게)
- 회전 정보 보정 (EXIF)
```

#### 이미지 조작
```
[기본 조작]
- 이동: 드래그
- 크기 조절: 모서리 핸들
- 회전: 회전 핸들 or 입력
- 삭제: Delete 키 or 버튼

[고급 조작] (P2)
- 좌우/상하 반전
- 투명도 조절
- 필터 (흑백, 세피아 등)
- 마스킹 (원형, 하트 등)
```

### 3.3 텍스트 편집 [P0]

#### 텍스트 추가
```
[추가]
- "텍스트 추가" 버튼 or 더블클릭
- 기본 텍스트: "텍스트를 입력하세요"

[편집]
- 인라인 편집 (더블클릭)
- 드래그로 이동
```

#### 텍스트 스타일링
| 속성 | 옵션 | MVP |
|------|------|-----|
| 폰트 | 10개 내장 폰트 | ✅ |
| 크기 | 8px ~ 200px | ✅ |
| 색상 | 컬러 피커 | ✅ |
| 굵기 | 일반/굵게 | ✅ |
| 정렬 | 좌/중/우 | ✅ |
| 외곽선 | 색상/두께 | P2 |
| 그림자 | 색상/거리/블러 | P2 |

#### 내장 폰트 (MVP)
```
1. Pretendard (한글 기본)
2. Noto Sans KR (한글)
3. Nanum Gothic (한글)
4. 나눔손글씨 붓 (손글씨)
5. 나눔손글씨 펜 (손글씨)
6. 배민 주아체 (귀여움)
7. 카페24 써라운드 (감성)
8. Inter (영문)
9. Playfair Display (영문 세리프)
10. Caveat (영문 필기체)
```

### 3.4 원클릭 테마컬러 변경 [P1]

#### 기능 설명
작가가 지정한 "변경 가능한 색상 영역"을 사용자가 원클릭으로 테마 컬러 변경

#### 구현 방식
```
[작가 설정 (틀 등록 시)]
1. 에디터에서 색상 영역 지정
2. 각 영역에 역할 부여 (배경색, 강조색, 텍스트색)
3. 기본 컬러 팔레트 설정

[사용자 편집 시]
1. "테마 컬러" 패널 열기
2. 컬러 피커로 원하는 색 선택
3. 지정된 모든 영역이 자동으로 색상 변경
4. 실시간 미리보기
```

#### UI
```
┌─ 테마 컬러 ─────────────────┐
│                            │
│  배경색    [████] 🎨       │
│  강조색    [████] 🎨       │
│  텍스트색  [████] 🎨       │
│                            │
│  [프리셋: 파스텔 | 다크 | 레트로]│
└────────────────────────────┘
```

### 3.5 자동 저장 [P0]

#### 저장 전략
```
[로컬 저장 (LocalStorage)]
- 5초마다 자동 저장
- 비로그인도 가능
- 브라우저 종료 시에도 유지
- 키: pairy_draft_{templateId}

[클라우드 저장 (Supabase)]
- 로그인 유저만
- 30초마다 동기화
- 협업 시 실시간 동기화

[복구 UX]
1. 에디터 진입 시 이전 작업 감지
2. "이전 작업을 불러올까요?" 팝업
3. "불러오기" / "새로 시작" 선택
```

### 3.6 내보내기 [P0]

#### 이미지 저장
| 형식 | 해상도 | 조건 |
|------|--------|------|
| PNG | 기본 (1x) | 모든 유저 |
| PNG | 고화질 (2x) | 프리미엄 |
| JPG | 압축 | 모든 유저 |

#### 저장 플로우
```
1. "저장하기" 버튼 클릭
2. 형식/해상도 선택
3. (무료 유저) 워터마크 추가 옵션
4. 이미지 생성
5. 다운로드 or 클립보드 복사
```

---

## 4. 실시간 협업 (Collaboration)

### 4.1 협업 세션 생성 [P0]

#### 세션 생성
```
[플로우]
1. 에디터에서 "협업하기" 버튼 클릭
2. 협업 링크 생성 (고유 ID)
3. 링크 복사 or 직접 공유
4. 링크 유효 기간: 24시간

[링크 형식]
https://pairy.io/collab/{sessionId}

[접근 권한]
- 링크 있으면 누구나 참여 가능
- 비로그인도 게스트로 참여
```

### 4.2 실시간 동기화 [P0]

#### 동기화 대상
- 캔버스 요소 (이미지, 텍스트)
- 요소 속성 (위치, 크기, 스타일)
- 커서 위치

#### 충돌 해결
```
[전략: Last Write Wins + 영역 분리]
- 같은 요소 동시 편집 시: 마지막 변경 반영
- 권장: 각자 담당 영역 편집 (왼쪽/오른쪽)
- 충돌 알림: "상대방이 이 요소를 편집 중입니다"
```

### 4.3 커서 표시 [P1]

#### 실시간 커서
```
[표시 정보]
- 상대방 커서 위치 (실시간)
- 커서 옆 이름 라벨
- 커서 색상 (유저별 다름)

[성능 최적화]
- 커서 위치: 100ms 디바운스
- 요소 변경: 즉시 동기화
```

### 4.4 협업 완료 [P0]

#### 완료 플로우
```
1. 양쪽 모두 "완료" 버튼 클릭
2. 최종 이미지 생성
3. 양쪽 모두 다운로드 가능
4. (선택) 갤러리에 공개
```

---

## 5. 보호 서비스 (Protection)

### 5.1 워터마크 [P0]

#### 자동 워터마크
```
[적용 조건]
- 무료 유저: 필수 적용
- 프리미엄 유저: 선택적

[워터마크 종류]
- 로고 워터마크 (우하단)
- 타일링 워터마크 (반투명 반복)

[설정]
- 위치: 모서리 4곳 선택
- 투명도: 20% ~ 80%
- 크기: 작음/중간/큼
```

### 5.2 패턴 오버레이 [P1]

#### 기능
```
[목적]
- AI 학습 방지 (Glaze 대안)
- 무단 복제 억제

[구현]
- 미세 격자 패턴 오버레이
- 육안으로는 거의 안 보임
- 이미지 분석 시 노이즈로 작용

[적용]
- 작가 선택 옵션
- 미리보기에만 적용 (에디터용은 제외)
```

### 5.3 우클릭 방지 [P1]

#### 기능
- 이미지 우클릭 비활성화
- 드래그 방지
- (우회 가능하지만 심리적 억제 효과)

### 5.4 신고 시스템 [P1]

#### 신고 유형
- 저작권 침해
- 무단 도용
- 부적절한 콘텐츠
- 스팸/광고
- 기타

#### 신고 플로우
```
1. 신고 버튼 클릭
2. 신고 유형 선택
3. 상세 내용 입력
4. 증거 자료 첨부 (선택)
5. 제출

[처리]
- 관리자 검토
- 3회 누적 시 자동 숨김
- 확정 시 콘텐츠 삭제 + 제재
```

---

## 6. 결제 시스템 (Payment)

### 6.1 프리미엄 구독 [P1]

#### 구독 플랜
| 플랜 | 가격 | 혜택 |
|------|------|------|
| 무료 | ₩0 | 기본 기능 |
| 프리미엄 | ₩3,900/월 | 광고 제거, 고화질, 무제한 저장 |
| 프로 | ₩9,900/월 | 작가 통계, 커스텀 브랜딩 |

#### 프리미엄 혜택 상세
```
[무료 vs 프리미엄]
                    무료        프리미엄
광고                O           X
저장 가능 작업       3개         무제한
이미지 해상도       1x          2x
협업 세션          1회/일       무제한
테마 컬러          기본 3종     전체
버전 히스토리       X           최근 10개
```

### 6.2 1일 이용권 [P1]

#### 설계
```
[용도]
- 찍먹(단건) 유저 공략
- 구독 전환 유도

[가격]
- ₩500/일 (24시간)

[혜택]
- 프리미엄과 동일
- 1회 협업 무제한
```

### 6.3 틀 구매 [P2]

#### 구매 플로우
```
1. 유료 틀 상세 페이지
2. "구매하기" 클릭
3. 결제 수단 선택
4. 결제 완료
5. "에디터로 열기" 활성화
```

#### 결제 수단
- 토스페이먼츠 (카드, 계좌이체)
- 카카오페이
- 네이버페이 (P3)

---

## 7. 마이페이지 (My Page)

### 7.1 내 작업물 [P1]

#### 기능
- 저장한 작업물 목록
- 이어서 편집
- 삭제

### 7.2 내 북마크 [P1]

#### 기능
- 북마크한 틀 목록
- 폴더 분류 (P2)

### 7.3 구매 내역 [P2]

#### 기능
- 구매한 틀 목록
- 구독 상태 확인
- 영수증 다운로드

### 7.4 프로필 설정 [P1]

#### 설정 항목
- 닉네임 변경
- 프로필 이미지 변경
- 자기소개 수정
- 연결된 소셜 계정 관리

---

## 8. 알림 시스템 (Notification)

### 8.1 인앱 알림 [P2]

#### 알림 종류
- 협업 초대
- 협업 참여 알림
- 팔로우 알림
- 좋아요 알림 (작가)
- 구독 만료 알림

### 8.2 이메일 알림 [P3]

#### 알림 종류
- 가입 환영
- 비밀번호 재설정
- 결제 영수증
- 주간 리포트 (작가)

---

## 9. 관리자 기능 (Admin)

### 9.1 대시보드 [P2]

#### 통계
- DAU/MAU
- 신규 가입
- 틀 등록 수
- 결제 현황

### 9.2 콘텐츠 관리 [P2]

#### 기능
- 신고된 콘텐츠 검토
- 틀 숨김/삭제
- 유저 제재

### 9.3 공지사항 [P2]

#### 기능
- 공지 작성/수정/삭제
- 팝업 공지
- 메인 배너 관리
